---
import AuthLayout from "../../layouts/AuthLayout.astro";
import { ResetPasswordForm } from "../../components/auth/ResetPasswordForm";

// Extract token from URL query parameters
// Supabase typically provides access_token or code in URL
const url = new URL(Astro.request.url);
const token = url.searchParams.get("token") || url.searchParams.get("access_token") || url.searchParams.get("code");

// TODO: Server-side validation of token
// Could also check if Supabase has established a session automatically
---

<AuthLayout title="Resetowanie hasła – AI Flashcards">
  <div class="space-y-8">
    <!-- Header -->
    <div class="text-center">
      <h1 class="text-3xl font-bold text-foreground mb-3">Ustaw nowe hasło</h1>
      <p class="text-muted-foreground">
        Wprowadź nowe hasło dla swojego konta
      </p>
    </div>

    <!-- Reset Password Form Card -->
    <div class="bg-card border rounded-lg p-6 shadow-sm">
      <ResetPasswordForm client:load token={token} />
    </div>
  </div>
</AuthLayout>
